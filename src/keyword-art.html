<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">

<!-- Gets top 5 art pieces relevant to given keyword -->
<dom-module id="keyword-art">

  <template>
    <style>
      :host {
        display: block;
        box-sizing: border-box;
      }
      img {
        border: none;
        height: 200px;
        width: inherit;
        position: relative;
        box-shadow: 16px 14px 0 0px #FFFFFF, 16px 14px 0 2px #1A09FF;
        margin:30px;
      }
      .modal {
        background-color: rgba(255,255,255,0.9);
        max-height: none !important;
        max-width: none !important;
        height: 100%;
        width: 100%;
        margin: 0;
        box-shadow: none;
      }
    </style>
    <iron-ajax
      auto
      url="{{url}}"
      handle-as="json"
      params="{{params}}"
      last-response="{{response}}"
    ></iron-ajax>
    <div>
      <!-- <h4>[[keyword]]</h4>
      <p>[[response.info.pages]]</p> -->
      <template is="dom-repeat" items="{{response.records}}">
        <!-- <p>{{item.title}}</p>
        <p>{{item.description}}</p> -->
          <img on-click="toggleModal" src="{{item.primaryimageurl}}">
          <paper-dialog id="artModal" class="modal" horizontal-align="left" vertical-align="top">
            <h2>Header</h2>
            <paper-dialog-scrollable>
              Lorem ipsum...
            </paper-dialog-scrollable>
            <div class="buttons">
              <paper-button dialog-dismiss>Cancel</paper-button>
            </div>
          </paper-dialog>
      </template>
  </div>
  </template>

  <script>
    Polymer({
      is: 'keyword-art',
      properties: {
          apikey: {
              value: "9c6efbf0-b43e-11e6-a912-5bf7795f06a9",
              notify: true
          },
          keyword: {
              value: "government",
              notify: true
          },
          url: {
              value: "http://api.harvardartmuseums.org/object"
          },
          params: {
              computed: "computeParams(apikey, keyword)"
          },
          response: {
              value: {},
              notify: true,
              observer: "responseChanged"
          },
          results: {
              type: Number,
              notify: true,
              observer: "resultsChanged"
          }
      },
      toggleModal: function(event){
        event.target.nextElementSibling.open();
      },
      resultsChanged: function(r) {

      },
      computeResults: function(r) {
          this.results = r;
      },
      computeParams: function (apikey, keyword) {
          return {apikey: apikey, keyword: keyword, size: 5};
      },
      responseChanged: function (resp) {
          if (resp.info) { this.computeResults(resp.info.totalrecords); };
      }
  });
  </script>
</dom-module>
